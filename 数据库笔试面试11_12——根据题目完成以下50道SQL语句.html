<!Doctype html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta charset="utf-8"/><meta name="referrer" content="always"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><link rel="shortcut icon" href="https://gss0.bdstatic.com/5bd1bjqh_Q23odCf/static/wiseindex/img/favicon64.ico" type="image/x-icon"><link rel="apple-touch-icon-precomposed" href="https://gss0.bdstatic.com/5bd1bjqh_Q23odCf/static/wiseindex/img/screen_icon_new.png"><title>数据库笔试面试11~12——根据题目完成以下50道SQL语句</title><link rel="stylesheet" href="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/css/land_min_pack_826b386.css"><meta itemprop="dateUpdate" content="2017-05-08 12:48:23" /></head><body><script >/* eslint-disable */var s_domain = {"protocol":"https:","staticUrl":"https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/","base":"","baseuri":"","passconf":"http://passport.baidu.com/ubrwsbas","logout":"https://passport.baidu.com/?logout&u=","bs":"https://www.baidu.com","sp":"http://hi.baidu.com/","ssllist":{"a.hiphotos.baidu.com":"ss0.baidu.com/94o3dSag_xI4khGko9WTAnF6hhy","b.hiphotos.baidu.com":"ss1.baidu.com/9vo3dSag_xI4khGko9WTAnF6hhy","c.hiphotos.baidu.com":"ss3.baidu.com/9fo3dSag_xI4khGko9WTAnF6hhy","d.hiphotos.baidu.com":"ss0.baidu.com/-Po3dSag_xI4khGko9WTAnF6hhy","e.hiphotos.baidu.com":"ss1.baidu.com/-4o3dSag_xI4khGko9WTAnF6hhy","f.hiphotos.baidu.com":"ss2.baidu.com/-vo3dSag_xI4khGko9WTAnF6hhy","g.hiphotos.baidu.com":"ss3.baidu.com/-fo3dSag_xI4khGko9WTAnF6hhy","h.hiphotos.baidu.com":"ss0.baidu.com/7Po3dSag_xI4khGko9WTAnF6hhy","1.su.bdimg.com":"ss0.bdstatic.com/k4oZeXSm1A5BphGlnYG","t10.baidu.com":"ss0.baidu.com/6ONWsjip0QIZ8tyhnq","t11.baidu.com":"ss1.baidu.com/6ONXsjip0QIZ8tyhnq","t12.baidu.com":"ss2.baidu.com/6ONYsjip0QIZ8tyhnq","himg.bdimg.com":"ss1.bdstatic.com/7Ls0a8Sm1A5BphGlnYG","cdn00.baidu-img.cn":"ss0.bdstatic.com/9bA1vGba2gU2pMbfm9GUKT-w","cdn01.baidu-img.cn":"ss0.bdstatic.com/9bA1vGfa2gU2pMbfm9GUKT-w"}};var s_session = {"ssid":"52e1085f","logid":"","sid":"","nid":"3101485368004088035","qid":""};var s_advert = {"isBjh":"1","contentUrl":"http://baijiahao.baidu.com/s?id=1566802045522374","contentPlatformId":"3","contentType":"1","pvid":"896f53d162150445","time":"2018-02-27 21:02:17","contentAccType":"1","ctk":"c090362b85e59792","contentAccId":"pHfKG4QQfG_HeRjlB","ctk_b":"5238f04d63ec2547","logid":"0137128527","dtime":"1519736537","grade":"0","createTimeAccLevel":"1"};</script><script>/* eslint-disable */var bds={se:{},su:{urdata:[],urSendClick:function(){},urStatic:"https://ss.bdimg.com"},util:{},use:{},comm:{domain:"",ubsurl:"",tn:"",queryEnc:"",queryId:"",inter:"",sugHost:"",query:"",qid:"",cid:"",sid:"",stoken:"",serverTime:"",user:"",username:"",loginAction:[],useFavo:"",pinyin:"",favoOn:"",curResultNum:"0",rightResultExist:false,protectNum:0,zxlNum:0,pageNum:1,pageSize:10,ishome:1,newindex:1}};var name,navigate,al_arr=[];var selfOpen=window.open;eval("var open = selfOpen;");var isIE=navigator.userAgent.indexOf("MSIE")!=-1&&!window.opera;var E=bds.ecom={};bds.se.mon={loadedItems:[],load:function(){},srvt:-1};try{bds.se.mon.srvt=parseInt(document.cookie.match(new RegExp("(^| )BDSVRTM=([^;]*)(;|$)"))[2]);document.cookie="BDSVRTM=;expires=Sat, 01 Jan 2000 00:00:00 GMT"}catch(e){}var bdUser=bds.comm.user?bds.comm.user:null,bdQuery=bds.comm.query,bdUseFavo=bds.comm.useFavo,bdFavoOn=bds.comm.favoOn,bdCid=bds.comm.cid,bdSid=bds.comm.sid,bdServerTime=bds.comm.serverTime,bdQid=bds.comm.queryId,bdstoken=bds.comm.stoken,login_success=[];</script><div id="detail-page"><div class="line-shadow"></div><div id="content-container" class="content-container clearfix" data-showlog="tid:126;cst:1;logInfo:landing;" data-extralog="flow:2;rid:;pos:;extra:;isBaijiahao:1;login:1;appId:1562763843220107;" data-ratio="1" data-rid="page"><div class="item-wrap"><div id="header_wrap" class="header_wrap"><div class="header_content"><div class="header_logo"><a href="https://www.baidu.com" id="result_logo" data-clklog="tid:139;cst:2;logInfo:head_logo;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;" data-rid="head_0"><img src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/img/logo_top.png" alt="到百度首页" title="到百度首页"></a></div><div class="header_menu" data-rid="header_menu"><a href="https://www.baidu.com" class="index" data-clklog="tid:142;cst:2;logInfo:head_menu" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;type:backindex" data-rid="head_1">百度首页</a><div id="userBlock"><a href="https://passport.baidu.com/v2/?login&tpl=mn&u=http://www.baidu.com" class="login" data-clklog="tid:142;cst:2;logInfo:head_menu;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;type:login" data-rid="head_2">登录</a><a href="http://i.baidu.com/" id="usrname" class="usrname" data-clklog="tid:142;cst:2;logInfo:head_menu;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;type:usrname;" data-rid="head_2"><span id="nametxt">轻狂书生1300</span><i class="c-icon"></i></a><div id="user_menu" data-showlog="tid:131;cst:1;logInfo:usrmenu;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;" class="s-isindex-wrap s-user-set-menu menu-top" style="display: none;"><div><a href="http://i.baidu.com/center" target="_blank" data-tid="1000" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;type:center;" data-rid="usr_menu_1">个人中心</a><a href="http://passport.baidu.com/" data-tid="1001" target="_blank" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;type:passport;" data-rid="usr_menu_2">帐号设置</a><a class="s-feedback" style="overflow:hidden" href="#" onclick="return false;" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:3;extra:;isBaiJiaHao:1;login:1;type:feedback;" data-rid="header_menu_3">意见反馈</a><a class="quit" style="overflow:hidden" href="https://passport.baidu.com/?logout&u=https://www.baidu.com" data-clklog="tid:146;cst:2;logInfo:usrmenu;" data-extralog="rid:;pos:4;extra:;isBaiJiaHao:1;login:1;type:quit;" data-rid="usr_menu_4">退出</a></div><span class="menu-arrow"><em></em></span></div></div></div></div></div></div><div id="left-container" class="left-container"><div class="item-wrap"><div class="article" id="article" data-islow-browser="0"><div class="article-title"><h2>数据库笔试面试11~12——根据题目完成以下50道SQL语句</h2></div><div class="article-desc clearfix"><div class="author-icon"><img src="https://timg01.bdimg.com/timg?pacompress&amp;imgtype=0&amp;sec=1439619614&amp;autorotate=1&amp;di=e90a49cc5169df6f09b63f1dc7ba413d&amp;quality=90&amp;size=b200_200&amp;src=http%3A%2F%2Fbos.nj.bpc.baidu.com%2Fv1%2Fmediaspot%2F7da1be1471494aeae7a9c0412ffb3079.jpeg"></div><div class="author-txt"><p class="author-name">日常教育</p><div class="article-source"><span class="source">百家号</span><span class="date">05-08</span><span class="time">12:48</span></div></div></div><div class="article-content"><div class="img-container"><img class="large" data-loadfunc=0 src="https://t10.baidu.com/it/u=1365394551,3980937166&amp;fm=170&amp;s=F8A421D0DA537CC6D3385F53030040FD&amp;w=640&amp;h=469&amp;img.JPEG" data-loaded=0></div><p>已知有如下4张表：</p><p>学生表：STUDENT(S#,SNAME,SAGE,SSEX)</p><p>课程表：COURSE(C#,CNAME,T#)</p><p>成绩表：SC(S#,C#,SCORE)</p><p>教师表：TEACHER(T#,TNAME)</p><p>其中，S#代表学号，SNAME代表学生姓名，SAGE代表学生年龄，SSEX代表学生性别，C#代表课程编号，CNAME代表课程名字，T#代表教师编号，TNAME代表教师名字，SCORE代表成绩。</p><p>根据以上信息按照下面要求写出对应的SQL语句。</p><p>1、查询课程编号为“001”的课程比“002”的课程成绩高的所有学生的学号</p><p>2、查询平均成绩大于60分的学生的学号和平均成绩</p><p>3、查询所有学生的学号、姓名、选课数、总成绩</p><p>4、查询姓“李”的老师的个数</p><p>5、查询没学过“李美玲”老师课的学生的学号、姓名</p><p>6、查询学过编号为“001”的课程并且也学过编号为“002”的课程的学生的学号、姓名</p><p>7、查询学过“李多多”老师所教的所有课的学生的学号、姓名</p><p>8、查询课程编号为“002”的总成绩</p><p>9、查询所有课程成绩小于60分的学生的学号、姓名</p><p>10、查询没有学全所有课的学生的学号、姓名</p><p>11、查询至少有一门课与学号为“1001”的学生所学课程相同的学生的学号和姓名</p><p>12、查询所学课程和学号为“001”的学生所有课程一样的其他学生的学号和姓名</p><p>13、把“SC”表中“李多多”老师教的课的成绩都更改为此课程的平均成绩</p><p>14、查询没有学习过“1002”号课程的的学生的学号和姓名</p><p>15、删除学习“李多多”老师课的SC表记录</p><p>16、向SC表中插入一些记录这些记录要求符合以下条件：没有上过编号为“003”课程的学生的学号、编号为002的课程的平均成绩</p><p>17、按平均成绩从高到低显示所有学生的“数据库”、“企业管理”、“英语”三门的课程成绩，其中数据库的c#为004，企业管理的c#为001，英语的c#为006，按如下形式显示：</p><p>学生ID数据库企业管理英语有效课程数有效平均成绩</p><p>18、查询各科成绩最高和最低的分，以如下形式显示课程ID最高分最低分</p><p>19、按各科平均成绩从低到高和及格率的百分数从高到低排列，以如下形式显示：</p><p>课程号课程名平均成绩及格百分数</p><p>20、查询如下课程平均成绩和及格率的百分数（用1行显示），其中企业管理为001，马克思为002，UML为003，数据库为004</p><p>21、查询不同老师所教不同课程平均分从高到低显示</p><p>22、查询如下课程成绩第3名到第6名的学生成绩单，其中企业管理为001，马克思为002，UML为003，数据库为004，以如下形式显示：</p><p>学生ID学生姓名企业管理马克思UML数据库平均成绩</p><p>23、使用分段[100-85],[85-70],[70-60],[&lt;60]来统计各科成绩，分别统计各分数段人数：课程ID和课程名称</p><p>24、查询学生平均成绩及其名次</p><p>25、查询各科成绩前三名的记录（不考虑成绩并列情况）</p><p>26、查询每门课程被选修的学生数</p><p>27、查询出只选修了一门课程的全部学生的学号和姓名</p><p>28、查询男生、女生人数</p><p>29、查询姓“张”的学生名单</p><p>30、查询同名同性学生名单并统计同名人数</p><p>31、1981年出生的学生名单（注：STUDENT表中SAGE列的类型是DATE）</p><p>32、查询每门课程的平均成绩，结果按平均成绩升序排列，平均成绩相同时按课程号降序排列</p><p>33、查询平均成绩大于85的所有学生的学号、姓名和平均成绩</p><p>34、查询课程名称为“数据库”且分数低于60的学生姓名和分数</p><p>35、查询所有学生的选课情况</p><p>36、查询任何一门课程成绩在70分以上的姓名、课程名称和分数</p><p>37、查询不及格的课程并按课程号从大到小排列</p><p>38、查询课程编号为003且课程成绩在80分以上的学生的学号和姓名</p><p>39、查询选了课程的学生人数</p><p>40、查询选修“李多多”老师所授课程的学生中成绩最高的学生姓名及其成绩</p><p>41、查询各个课程及相应的选修人数</p><p>42、查询有2门不同课程成绩相同的学生的学号、课程号、学生成绩</p><p>43、查询每门课程成绩最好的前两名</p><p>44、查询每门课程的学生选修人数，超过10人的课程才统计。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同按课程号升序排列</p><p>45、查询至少选修两门课程的学生学号</p><p>46、查询全部学生都选修的课程的课程号和课程名</p><p>47、查询没学过“李多多”老师讲授的任一门课程的学生姓名</p><p>48、查询两门以上不及格课程的同学的学号及其平均成绩</p><p>49、检索课程编号为“004”且分数小于60的学生学号，结果按按分数降序排列</p><p>50、删除学生编号为“002”的课程编号为“001”的课程的成绩</p><p>本题考察SQL的编写能力，对于这类型的题目，只要把4张表之间的关联关系搞清楚了，编写对应的SQL语句就比较容易了，本题给出的四张表之间的关系如下图所示：</p><div class="img-container"><img class="large" data-loadfunc=0 src="https://t12.baidu.com/it/u=4041214775,1599513297&amp;fm=170&amp;s=A498E03397D44C625E5DF4DB0000E0B1&amp;w=640&amp;h=218&amp;img.JPEG" data-loaded=0></div><p>1、答案：首先查询课程编号分别为001和002的所有学生的学号及其分数作为内嵌视图A和B，然后将A和B通过学号关联，过滤条件就是A的分数大于B的分数，最终SQL如下：</p><p>SELECTA.S#</p><p>FROM(SELECTS#,SCOREFROMSCWHEREC#=&#039;001&#039;)A,</p><p>(SELECTS#,SCOREFROMSCWHEREC#=&#039;002&#039;)B</p><p>WHEREA.SCORE&gt;B.SCORE</p><p>ANDA.S#=B.S#;</p><p>2、答案：该内容通过SC表即可获取，按照SC表的S#分组后即可求出平均成绩，最后通过HAVING子句来过滤平均分大于60的学生，最终SQL如下：</p><p>SELECTS#,AVG(SCORE)</p><p>FROMSC</p><p>GROUPBYS#</p><p>HAVINGAVG(SCORE)&gt;60;</p><p>3、答案：学生姓名通过STUDENT表获取，成绩通过SC表获取，考察的是COUNT和GROUPBY函数，最终SQL如下：</p><p>SELECTSTUDENT.S#,STUDENT.SNAME,COUNT(SC.C#),SUM(SCORE)</p><p>FROMSTUDENT</p><p>LEFTOUTERJOINSC</p><p>ONSTUDENT.S#=SC.S#</p><p>GROUPBYSTUDENT.S#,SNAME;</p><p>4、答案：老师通过TEACHER表即可查询，考察模糊查询，最终SQL如下：</p><p>SELECTCOUNT(DISTINCT(TNAME))</p><p>FROMTEACHER</p><p>WHERETNAMELIKE&#039;李%&#039;;</p><p>5、答案：首先查询学习过“李美玲”老师课的学生的学号作为子查询，而“李美玲”老师涉及到TEACHER表，TEACHER表要和学生有关联必须通过课程和成绩表，最终SQL如下：</p><p>SELECTSTUDENT.S#,STUDENT.SNAME</p><p>WHERES#NOTIN(SELECTDISTINCT(SC.S#)</p><p>FROMSC,COURSE,TEACHER</p><p>WHERESC.C#=COURSE.C#</p><p>ANDTEACHER.T#=COURSE.T#</p><p>ANDTEACHER.TNAME=&#039;李美玲&#039;);</p><p>6、答案：这道题需要注意的是“且”这个关键词，说明查询出来的学生即学习过001也学习过002的课程，最终SQL如下：</p><p>FROMSTUDENT,SC</p><p>WHERESTUDENT.S#=SC.S#</p><p>ANDSC.C#=&#039;001&#039;</p><p>ANDEXISTS(SELECT*</p><p>FROMSCASSC_2</p><p>WHERESC_2.S#=SC.S#</p><p>ANDSC_2.C#=&#039;002&#039;);</p><p>错误答案：</p><p>ANDSC.C#IN(&#039;001&#039;，&#039;002&#039;);</p><p>7、答案：这道题和第6题比较相似，需要理解题意，题目说的是查询学过“李多多”老师所教的所有课的同学的学号、姓名，举个例子，比如“李多多”老师教过语文和数学，那么就得找出哪些同学同时学习了语文和数学这2门课程，最终SQL如下：</p><p>SELECTS#,SNAME</p><p>WHERES#IN(SELECTS#</p><p>ANDTEACHER.TNAME=&#039;李多多&#039;</p><p>HAVINGCOUNT(SC.C#)=(SELECTCOUNT(C#)</p><p>FROMCOURSE,TEACHER</p><p>WHERETEACHER.T#=COURSE.T#</p><p>ANDTNAME=&#039;李多多&#039;));</p><p>WHERES#IN(SELECTS#FROMSC,COURSE,TEACHER</p><p>WHERESC.C#=COURSE.C#</p><p>ANDTEACHER.TNAME=&#039;李多多&#039;);</p><p>8、答案：本题考查SUM函数，最终SQL如下所示：</p><p>SELECTSUM(SCORE)FROMSCSC_2WHERESC_2.C#=&#039;002&#039;;</p><p>9、答案：涉及到学生表和成绩表，比较简单，最终SQL如下：</p><p>WHERES#NOTIN(SELECTSTUDENT.S#</p><p>WHERESCORE&gt;=60);</p><p>10、答案：没有学全所有课，翻译一下就是学生学习的课程数小于总的课程数，最终SQL如下：</p><p>GROUPBYSTUDENT.S#,STUDENT.SNAME</p><p>HAVINGCOUNT(C#)&lt;(SELECTCOUNT(C#)FROMCOURSE);</p><p>11、答案：首先找出学号为1001的学生学习过的课程，然后根据这些课程号就可以找到有哪些学生学习过部分1001学生学习过的课程，最终SQL如下：</p><p>ANDC#IN(SELECTC#FROMSCWHERES#=&#039;1001&#039;);</p><p>SELECTSC.S#,SNAME;</p><p>12、答案：首先找出学号为1001的学生学习过的课程，然后根据这些课程号和所学课程总数就可以找到有哪些同学学习过和他一样的课程，最终SQL如下：</p><p>ANDC#IN(SELECTC#FROMSCWHERES#=&#039;001&#039;)</p><p>HAVINGCOUNT(C#)=(SELECTCOUNT(C#)FROMSCWHERES#=&#039;001&#039;);</p><p>13、答案：首先找到李多多老师教过哪些课程及其课程的平均成绩，然后根据课程号关联成绩表进行更新，最终SQL如下：</p><p>UPDATESC</p><p>SETSCORE=</p><p>(SELECTAVG(SC_2.SCORE)</p><p>FROMCOURSE,TEACHER,SCSC_2</p><p>WHERECOURSE.T#=TEACHER.T#</p><p>ANDCOURSE.C#=SC_2.C#</p><p>ANDSC_2.C#=SC.C#</p><p>GROUPBYCOURSE.C#)</p><p>WHEREEXISTS(SELEC1FROMCOURSE,</p><p>TEACHER,</p><p>SCSC_2WHERECOURSE.T#=TEACHER.T#</p><p>GROUPBYCOURSE.C#</p><p>);</p><p>14、答案：本题比较简答，最终SQL如下：</p><p>ANDC#NOTIN(SELECTC#FROMSCWHERES#=&#039;1002&#039;);</p><p>15、答案：本题比较简答，最终SQL如下：</p><p>DELETEFROMSC</p><p>WHERESC.C#IN</p><p>(SELECTCOURSE.C#FROMCOURSEC,TEACHERTWHEREC.T#=T.T#ANDT.TNAME=&#039;李多多&#039;);</p><p>16、答案：2个点，002课程的平均成绩和没有学习过003课程的学生，最终SQL如下：</p><p>INSERTINTOSC(S#,C#,SCORE)</p><p>SELECTS#,&#039;002&#039;,(SELECTAVG(SCORE)FROMSCWHEREC#=&#039;002&#039;)</p><p>WHERES#NOTIN(SELECTS#FROMSCWHEREC#=&#039;003&#039;);</p><p>17、答案：查看标量子查询，最终SQL如下：</p><p>SELECTS#AS学生ID,</p><p>(SELECTSCOREFROMSCWHERESC.S#=T.S#ANDC#=&#039;004&#039;)AS数据库,</p><p>(SELECTSCOREFROMSCWHERESC.S#=T.S#ANDC#=&#039;001&#039;)AS企业管理,</p><p>(SELECTSCOREFROMSCWHERESC.S#=T.S#ANDC#=&#039;006&#039;)AS英语,</p><p>COUNT(*)AS有效课程数,</p><p>AVG(T.SCORE)AS平均成绩</p><p>FROMSCAST</p><p>ORDERBYAVG(T.SCORE)DESC;</p><p>18、答案：最终SQL如下：</p><p>SELECTC#AS课程ID,MAX(SCORE)AS最高分,MIN(SCORE)AS最低分</p><p>GROUPBYC#;</p><p>19、答案：最终SQL如下：</p><p>SELECTT.C#AS课程号,</p><p>MAX(COURSE.CNAME)AS课程名,</p><p>NVL(AVG(SCORE),0)AS平均成绩,</p><p>((100*SUM(CASE</p><p>WHENNVL(SCORE,0)&gt;=60THEN</p><p>1</p><p>ELSE</p><p>0</p><p>END))/COUNT(*))AS及格百分数</p><p>FROMSCT,COURSEC</p><p>WHERET.C#=C.C#</p><p>GROUPBYT.C#</p><p>ORDERBY平均成绩,</p><p>END))/COUNT(*));</p><p>20、答案：最终SQL如下：</p><p>SELECTSUM(CASEWHENC#=&#039;001&#039;THENSCOREELSE0END)/SUM(CASEC#WHEN&#039;001&#039;THEN1ELSE0END)AS企业管理平均分,</p><p>100*SUM(CASEWHENC#=&#039;001&#039;ANDSCORE&gt;=60THEN1ELSE0END)/SUM(CASEWHENC#=&#039;001&#039;THEN1ELSE0END)AS企业管理及格百分数,</p><p>SUM(CASEWHENC#=&#039;002&#039;THENSCOREELSE0END)/SUM(CASEC#WHEN&#039;002&#039;THEN1ELSE0END)AS马克思平均分,</p><p>100*SUM(CASEWHENC#=&#039;002&#039;ANDSCORE&gt;=60THEN1ELSE0END)/SUM(CASEWHENC#=&#039;002&#039;THEN1ELSE0END)AS马克思及格百分数,</p><p>SUM(CASEWHENC#=&#039;003&#039;THENSCOREELSE0END)/SUM(CASEC#WHEN&#039;003&#039;THEN1ELSE0END)ASUML平均分,</p><p>100*SUM(CASEWHENC#=&#039;003&#039;ANDSCORE&gt;=60THEN1ELSE0END)/SUM(CASEWHENC#=&#039;003&#039;THEN1ELSE0END)ASUML及格百分数,</p><p>SUM(CASEWHENC#=&#039;004&#039;THENSCOREELSE0END)/SUM(CASEC#WHEN&#039;004&#039;THEN1ELSE0END)AS数据库平均分,</p><p>100*SUM(CASEWHENC#=&#039;004&#039;ANDSCORE&gt;=60THEN1ELSE0END)/SUM(CASEWHENC#=&#039;004&#039;THEN1ELSE0END)AS数据库及格百分数</p><p>FROMSC;</p><p>21、答案：最终SQL如下：</p><p>SELECTZ.T#AS教师ID,</p><p>Z.TNAMEAS教师姓名,</p><p>C.C#AS课程,</p><p>C.CNAMEAS课程名称,</p><p>AVG(SCORE)AS平均成绩</p><p>FROMSCAST,COURSEASC,TEACHERASZ</p><p>ANDC.T#=Z.T#</p><p>GROUPBYC.C#,Z.T#,Z.TNAME,C.CNAME</p><p>ORDERBYAVG(SCORE)DESC;</p><p>22、答案：最终SQL如下：</p><p>SELECTSC.S#AS学生学号,</p><p>STUDENT.SNAMEAS学生姓名,</p><p>T1.SCOREAS企业管理,</p><p>T2.SCOREAS马克思,</p><p>T3.SCOREASUML,</p><p>T4.SCOREAS数据库,</p><p>NVL(T1.SCORE,0)+NVL(T2.SCORE,0)+NVL(T3.SCORE,0)+</p><p>NVL(T4.SCORE,0)AS总分</p><p>LEFTJOIN(SELECT*</p><p>FROM(SELECTNB.S#,</p><p>NB.SCORE,</p><p>(RANK（）OVER(PARTITIONBYNB.S#ORDERBYNB.SCORE))RK</p><p>FROMSCNB</p><p>WHERENB.C#=&#039;001&#039;)</p><p>WHERERK&lt;=6</p><p>ANDRK&gt;=3)AST1</p><p>ONSC.S#=T1.S#</p><p>WHERENB.C#=&#039;002&#039;)</p><p>ANDRK&gt;=3)AST2</p><p>ONSC.S#=T2.S#</p><p>(RANK()OVER(PARTITIONBYNB.S#ORDERBYNB.SCORE))RK</p><p>WHERENB.C#=&#039;003&#039;)</p><p>ANDRK&gt;=3)AST3</p><p>ONSC.S#=T3.S#</p><p>WHERENB.C#=&#039;004&#039;)</p><p>ANDRK&gt;=3)AST4</p><p>ONSC.S#=T4.S#</p><p>WHERESTUDENT.S#=SC.S#;</p><p>23、答案：最终SQL如下：</p><p>SELECTSC.C#AS课程ID,</p><p>CNAMEAS课程名称,</p><p>SUM(CASEWHENSCOREBETWEEN85AND100THEN1ELSE0END)AS&quot;[100-85]&quot;,</p><p>SUM(CASEWHENSCOREBETWEEN70AND85THEN1ELSE0END)AS&quot;[85-70]&quot;,</p><p>SUM(CASEWHENSCOREBETWEEN60AND70THEN1ELSE0END)AS&quot;[70-60]&quot;,</p><p>SUM(CASEWHENSCORE&lt;60THEN1ELSE0END)AS&quot;[60-]&quot;</p><p>FROMSC,COURSE</p><p>WHERESC.C#=COURSE.C#</p><p>GROUPBYSC.C#,CNAME;</p><p>24、答案：最终SQL如下：</p><p>SELECTS#AS学生学号,RKAS名次,平均成绩</p><p>FROM(SELECTS#,</p><p>AVG(SCORE)平均成绩,</p><p>SUM(SCORE)总成绩,</p><p>(RANK()OVER(PARTITIONBYS#ORDERBYSUM(SCORE)DESC))RK</p><p>GROUPBYS#)AST2</p><p>ORDERBY名次DESC;</p><p>25、答案：最终SQL如下：</p><p>SELECTT1.S#AS学生ID,T1.C#AS课程ID,SCOREAS分数</p><p>FROMSCT1</p><p>WHERESCOREIN</p><p>(SELECTTOP3SCOREFROMSCWHERET1.C#=C#ORDERBYSCOREDESC)</p><p>ORDERBYT1.C#;</p><p>26、答案：最终SQL如下：</p><p>SELECTC#,COUNT(S#)FROMSCGROUPBYC#;</p><p>27、答案：最终SQL如下：</p><p>SELECTSC.S#,STUDENT.SNAME</p><p>FROMSC,STUDENT</p><p>WHERESC.S#=STUDENT.S#</p><p>GROUPBYSC.S#,STUDENT.SNAME</p><p>HAVINGCOUNT(C#)=1;</p><p>28、答案：最终SQL如下：</p><p>SELECTSUM(CASEWHENSSEX=&#039;男&#039;THEN1ELSE0)AS男生人数,</p><p>SUM(CASEWHENSSEX=&#039;女&#039;THEN1ELSE0)AS女生人数</p><p>GROUPBYSSEX;</p><p>29、答案：最终SQL如下：</p><p>SELECTSNAMEFROMSTUDENTWHERESNAMELIKE&#039;张%&#039;;</p><p>30、答案：最终SQL如下：</p><p>SELECTSNAME,COUNT(*)FROMSTUDENTGROUPBYSNAMEHAVINGCOUNT(*)&gt;1;</p><p>31、答案：最终SQL如下：</p><p>SELECTSNAME</p><p>WHERETO_CHAR(STUDENT.SAGE,&#039;YYYY&#039;)=&#039;1981&#039;;</p><p>32、答案：最终SQL如下：</p><p>SELECTC#,AVG(SCORE)FROMSCGROUPBYC#ORDERBYAVG(SCORE),C#DESC;</p><p>33、答案：最终SQL如下：</p><p>SELECTSNAME,SC.S#,AVG(SCORE)</p><p>GROUPBYSC.S#,SNAME</p><p>HAVINGAVG(SCORE)&gt;85;</p><p>34、答案：最终SQL如下：</p><p>SELECTSNAME,NVL(SCORE,0)</p><p>FROMSTUDENT,SC,COURSE</p><p>ANDSC.C#=COURSE.C#</p><p>ANDCOURSE.CNAME=&#039;数据库&#039;</p><p>ANDSCORE&lt;60;</p><p>35、答案：最终SQL如下：</p><p>SELECTSC.S#,SC.C#,SNAME,CNAME</p><p>FROMSC,STUDENT,COURSE</p><p>ANDSC.C#=COURSE.C#;</p><p>36、答案：最终SQL如下：</p><p>SELECTDISTINCTSTUDENT.S#,STUDENT.SNAME,SC.C#,SC.SCORE</p><p>WHERESC.SCORE&gt;=70</p><p>ANDSC.S#=STUDENT.S#;</p><p>37、答案：最终SQL如下：</p><p>SELECTC#FROMSCWHERESCORE&lt;60ORDERBYC#;</p><p>38、答案：最终SQL如下：</p><p>ANDSCORE&gt;80</p><p>ANDC#=&#039;003&#039;;</p><p>39、答案：最终SQL如下：</p><p>SELECTCOUNT(DISTINCTS#)FROMSCGROUPBYS#;</p><p>40、答案：最终SQL如下：</p><p>SELECTSTUDENT.SNAME,SCORE</p><p>FROMSTUDENT,SC,COURSEC,TEACHER</p><p>ANDSC.C#=C.C#</p><p>ANDC.T#=TEACHER.T#</p><p>ANDSC.SCORE=(SELECTMAX(SCORE)FROMSCWHEREC#=C.C#);</p><p>41、答案：最终SQL如下：</p><p>SELECTC#,COUNT(*)FROMSCGROUPBYC#;</p><p>42、答案：最终SQL如下：</p><p>SELECTDISTINCTA.S#,A.C#,B.SCORE</p><p>FROMSCA,SCB</p><p>WHEREA.SCORE=B.SCORE</p><p>ANDA.S#=B.S#</p><p>ANDA.C#&lt;&gt;B.C#;</p><p>43、答案：最终SQL如下：</p><p>FROM(SELECTS#,C#,(RANK（）OVER(PARTITIONBYC#ORDERBYSCOREDESC))RK</p><p>FROMSC)T1</p><p>WHERERK&lt;=2;</p><p>44、答案：最终SQL如下：</p><p>SELECTC#AS课程号,COUNT(*)AS人数</p><p>GROUPBYC#</p><p>HAVINGCOUNT(*)&gt;10</p><p>ORDERBYCOUNT(*)DESC,C#;</p><p>45、答案：最终SQL如下：</p><p>SELECTS#FROMSCGROUPBYS#HAVINGCOUNT(*)&gt;=2;</p><p>46、答案：最终SQL如下：</p><p>SELECTC#,CNAME</p><p>FROMCOURSE</p><p>WHEREC#IN(SELECTC#</p><p>FROM(SELECTC#,COUNT(DISTINCTS#)CS#FROMSCGROUPBYC#)</p><p>WHERECS#=(SELECTCOUNT(*)FROMSTUDENT));</p><p>47、答案：最终SQL如下：</p><p>WHERES#NOTIN(SELECTS#</p><p>FROMCOURSE,TEACHER,SC</p><p>ANDTNAME=&#039;李多多&#039;);</p><p>48、答案：最终SQL如下：</p><p>SELECTS#,AVG(NVL(SCORE,0))</p><p>WHERES#IN</p><p>(SELECTS#FROMSCWHERESCORE&lt;60GROUPBYS#HAVINGCOUNT(*)&gt;2)</p><p>GROUPBYS#;</p><p>49、答案：最终SQL如下：</p><p>SELECTS#</p><p>WHEREC#=&#039;004&#039;</p><p>ANDSCORE&lt;60</p><p>ORDERBYSCOREDESC;</p><p>50、答案：最终SQL如下：</p><p>WHERES#=&#039;002&#039;</p><p>ANDC#=&#039;001&#039;;</p></div><div class="notice"><p>本文仅代表作者观点，不代表百度立场。系作者授权百家号发表，未经许可不得转载。</p></div><audio height="0" width="0" id="musicAudio" data-play-index><source></source></audio></div></div></div><div id="right-container" class="right-container"><div class="item-wrap"><div class="author"><div class="author-info clearfix"><div class="author-icon"><img src="https://timg01.bdimg.com/timg?pacompress&amp;imgtype=0&amp;sec=1439619614&amp;autorotate=1&amp;di=e90a49cc5169df6f09b63f1dc7ba413d&amp;quality=90&amp;size=b200_200&amp;src=http%3A%2F%2Fbos.nj.bpc.baidu.com%2Fv1%2Fmediaspot%2F7da1be1471494aeae7a9c0412ffb3079.jpeg"></div><div class="author-txt"><p class="author-name">日常教育</p><div class="article-source"><span class="source">百家号</span><span>最近更新：</span><span class="date">05-08</span><span class="time">12:48</span></div></div></div><div class="author-desc"><p>简介:分享不同的学习和教学的经验和心得</p></div></div></div><div class="item-wrap"><div class="recent-article" data-pos=""><h2>作者最新文章</h><ul><li data-showlog="tid:135;cst:1;logInfo:recent_article;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;"  data-rid="recent_article_0"><h3 class="item-title"><a href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_10394737325123882079%22%7D&amp;n_type=1&amp;p_from=3" data-clklog="tid:147;cst:2;logInfo:recent_article;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;" target="_blank">教室里的可爱学生妹</a></h3><div class="item-desc hide"><span class="info-date">02-21</span><span class="info-time">08:10</span></div></li><li data-showlog="tid:135;cst:1;logInfo:recent_article;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;"  data-rid="recent_article_1"><h3 class="item-title"><a href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9643518652665586265%22%7D&amp;n_type=1&amp;p_from=3" data-clklog="tid:147;cst:2;logInfo:recent_article;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;" target="_blank">探索教育系列——21张照片引发的思考</a></h3><div class="item-desc hide"><span class="info-date">02-14</span><span class="info-time">13:34</span></div></li><li data-showlog="tid:135;cst:1;logInfo:recent_article;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;"  data-rid="recent_article_2"><h3 class="item-title"><a href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_9238712199582461046%22%7D&amp;n_type=1&amp;p_from=3" data-clklog="tid:147;cst:2;logInfo:recent_article;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;" target="_blank">我国人文社会科学的最高学府-----中国人民大学，刘强东毕业于此</a></h3><div class="item-desc hide"><span class="info-date">02-13</span><span class="info-time">18:03</span></div></li></ul></div></div><div class="item-wrap"><div class="related-news"><div class="news-content "><h2>相关文章</h2><ul><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:0;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_0"><div class="item-content clearfix"><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_15335929745204853956%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://t12.baidu.com/it/u=35626412,3683267651&amp;fm=173&amp;s=0D705382EA0208DEECF9C49103008090&amp;w=218&amp;h=146&amp;img.JPEG"></a></div><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:0;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_15335929745204853956%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">开学季民警来上安全课 为学生送上“安全大礼包”</a></h3></div><div class="news-desc"><span class="info-num">凤凰新闻</span><span class="info-date">02-27</span></div></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:1;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_1"><div class="item-content clearfix"><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_8137875203287573316%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://t10.baidu.com/it/u=2675600265,4124995462&amp;fm=173&amp;s=F43F31D4405A01D4416AAF800300508E&amp;w=218&amp;h=146&amp;img.JPEG"></a></div><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:1;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_8137875203287573316%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">外交部：来半岛出现缓和局面 望美朝对话早日进行</a></h3></div><div class="news-desc"><span class="info-num">网易新闻</span><span class="info-date">02-27</span></div></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:2;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_2"><div class="item-content clearfix"><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_15952142408529451472%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://t12.baidu.com/it/u=3462438512,985632024&amp;fm=173&amp;s=5604F40D5E31449ADCA0F5DA0100C0B0&amp;w=218&amp;h=146&amp;img.JPEG"></a></div><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:2;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_15952142408529451472%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">索尼XZ2怎么样？来看看内部人士的说法</a></h3></div><div class="news-desc"><span class="info-num">凤凰科技</span><span class="info-date">02-27</span></div></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:3;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_3"><div class="item-content clearfix"><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:3;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_6339623093852322478%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://t11.baidu.com/it/u=3584196997,2361508530&amp;fm=173&amp;s=9AB469848C3A48949720E1820300709B&amp;w=218&amp;h=146&amp;img.JPEG"></a></div><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:3;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_6339623093852322478%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">朴槿惠老死狱中？韩检方要求判处30年有期徒刑！</a></h3></div><div class="news-desc"><span class="info-num">环球网</span><span class="info-date">02-27</span></div></div></div></li><li data-showlog="tid:136;cst:1;logInfo:related_news;" data-extralog="flow:2;rid:;pos:4;extra:;isBaiJiaHao:1;login:1;"  data-rid="related_news_4"><div class="item-content clearfix"><div class="news-pic"><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:4;extra:;isBaiJiaHao:1;login:1;type:'img'" href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_7853802256605308162%22%7D&amp;n_type=1&amp;p_from=4" target="_blank"><img src="https://t10.baidu.com/it/u=4239486225,3225816322&amp;fm=173&amp;s=C8A31D72434A76EC9AC47A6F0300B064&amp;w=218&amp;h=146&amp;img.JPEG"></a></div><div class="news-info"><div class="news-title"><h3><a class="upgrade" data-clklog="tid:148;cst:2;logInfo:related_news;" data-extralog="rid:;pos:4;extra:;isBaiJiaHao:1;login:1;type:'title'"  href="https://mbd.baidu.com/newspage/data/landingsuper?context=%7B%22nid%22%3A%22news_7853802256605308162%22%7D&amp;n_type=1&amp;p_from=4" target="_blank">互联网巨头缘何扎堆保险市场</a></h3></div><div class="news-desc"><span class="info-num">网易新闻</span><span class="info-date">02-27</span></div></div></div></li></ul></div></div><div id="relateAd" ad-id="relate-js" class="wangmeng-ad" data-showlog="tid:369;cst:1;logInfo:adsjs;" data-clklog="tid:370;cst:2;logInfo:adsjs;" data-extralog="rid:;pos:5;extra:;baijiahao:1;login:1;"></div></div></div></div><div id="bottom-container" class="bottom-container "><div class="copy-right"><div class="baidu-info"><a class="sethome" href="//www.baidu.com/cache/sethelp/index.html" target="_blank"><span>设为首页</span></a><span class="copyright-text"><span>&#169;&nbsp;Baidu&nbsp;</span><a href="//www.baidu.com/duty/" target="_blank">使用百度前必读</a>&nbsp;<a href="http://jianyi.baidu.com" target="_blank">意见反馈</a>&nbsp;<span>京ICP证030173号&nbsp;</span><img width=13 height=16 src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superman/img/copy_rignt_24.png" /></span></div><div class="recordcode"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11000002000001"  target="_blank"><i></i>京公网安备11000002000001号</a></div></div><div class="back-to-top" data-showlog="tid:133;cst:1;logInfo:back_to_top;" data-clklog="tid:138;cst:2;logInfo:back_to_top;" data-extralog="rid:;pos:;extra:;isBaiJiaHao:1;login:1;" data-rid="back_to_top"><div class="icon-text"><span>返回顶部</span></div><div class="icon-arrow"><span></span></div></div></div></div><script type="text/javascript">(function () {var contentContainer = document.getElementById('content-container');var bottomContainer = document.getElementById('bottom-container');var rightContainer = document.getElementById('right-container');var minContentHeight = window.innerHeight - bottomContainer.offsetHeight;if (contentContainer.offsetHeight < minContentHeight) {contentContainer.style.height = minContentHeight + 'px';bottomContainer.className += ' fixed';}if (rightContainer.children.length === 0) {rightContainer.style.width = parseInt(rightContainer.offsetWidth + 1, 10) + 'px';}})();</script><script type="text/javascript" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/js/lib/jquery_0affbc1.js"></script><script type="text/javascript" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/js/land_min_pack_d549880.js"></script><script type="text/javascript" src="https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superlanding/js/article/index_648df39.js"></script></body></html>